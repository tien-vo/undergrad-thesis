
\section{The local expansion operator}\label{sec:expansion_operator}

The non-relativistic equation of motion can be written as
$d\vb{p}/dt=\vb{F}(t,\vb{r},\vb{v})$ where $\vb{p}=(\vb{r},\vb{v})$ is a
position in 6-D phase space and $\vb{F}$ is determined by the usual Lorentz
equation with $d\vb{r}/dt=\vb{v}$. It is convenient to expand the wave fields to
the complex field here when taking the Jacobian. We write
$\vb{E}=\qty(E_x^w\xhat+iE_y^w\yhat+E_z^w\zhat)e^{i\psi}$ and
$\vb{B}=\qty(-iB_x^w\xhat+B_y^w\yhat-iB_z^w\zhat)e^{i\psi}+B_0\zhat$. Then the
Jacobian of the system is
\begin{equation}
    \grad\vb{F}=\vb{F}\otimes\mqty[\grad_{\vb{r}}&\grad_{\vb{v}}]^T=\mqty(0&\mathbb{1}_3\\\qty(\vb{E}+\vb{v}\times\vb{B})\otimes\qty(i\vb{k})&\Omega_B)
\end{equation}
where $\otimes$ is the outer product, $\mathbb{1}_3$ is the three-dimensional identity matrix, and the magnetic rotation term
$\Omega_B=\grad_{\vb{v}}\qty(\vb{v}\times\vb{B})$ is
\begin{equation}
    \Omega_B=\mqty(0&B_z&-B_y\\-B_z&0&B_x\\B_y&-B_x&0)
\end{equation}
Now, consider two ``very close'' solutions of the equation of
motion $\vb{X},\vb{\tilde{X}}$ up to a small radius $\delta$. We can write
\begin{equation}
    \frac{d(\vb{X}(t)-\vb{\tilde{X}}(t))}{dt}=\vb{F}\qty(t,\vb{X}(t))-\vb{F}(t,\vb{\tilde{X}}(t))\sim\grad\vb{F}\vdot\qty(\vb{X}(t)-\vb{\tilde{X}}(t))
\end{equation}
up to a linear approximation. The corresponding forward time, finite difference expression of this is
$\Delta\vb{X}(t+\Delta t)\approx\Delta\vb{X}(t)+\Delta
t\grad\vb{F}\vdot\Delta\vb{X}(t)$
where $\Delta\vb{X}=\vb{X}-\vb{\tilde{X}}$. Then the local expansion at the
$n$th time step can be written as $\vb{M}_n=\mathbb{1}_6+\Delta t\grad{\vb{F}_n}$
where
\begin{equation}\label{eq:local_expansion}
    \Delta\vb{X}_{n+1}=\vb{M}_n\vdot\Delta\vb{X}_n
\end{equation}

